<html>
<script src="https://unpkg.com/dexie@latest/dist/dexie.js"></script>
<script src="setup.js"></script>
<script src="makeTable.js"></script>
<body>
</body>
<script>
</script>
<script>
const SUPPORTED_TYPES = {
  'any': "anyOf",
  'anyi': "anyOfIgnoreCase"
}
// not used for now... also wrong format
const SUPPORTED_FIELDS = [
  "id",
  "project",
  "modality",
  "site",
  "project,modality",
  "project,modality,site"
]
  var db = setupData(2)
  db.repo.toArray(console.log)
  let searchParams = new URLSearchParams(window.location.search)
  // TODO check all
  if(searchParams.has("fields")){
    let fields = decodeURIComponent(searchParams.get('fields'))
    fields = JSON.parse(fields.replace("~","+"))
    let type = decodeURIComponent(searchParams.get('type'))
    let query = JSON.parse(decodeURIComponent(searchParams.get('query')))
    db.repo.where(fields).anyOf(query).toArray(makeTable).catch(x=>{console.log(x)})
  } else {
    db.repo.toArray(makeTable)
  }
  // see querying at https://dexie.org/docs/Table/Table.where()
</script>
<body>
</body>
</html>
